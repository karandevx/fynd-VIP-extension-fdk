(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{default:()=>d});var a={};e.r(a),e.d(a,{Component:()=>l,GET_PRODUCT_DETAILS:()=>s,settings:()=>i});const n=require("fs");var o=e.n(n);const r={product:"gONOQ",container:"aQaT4"};function c({product:e,isVipOnly:t}){const{name:a,slug:n,media:c,price:s,item_code:l,rating:i,short_description:d,brand:u}=e,p=c&&c.length>0?c[0].url:"",m=s?.effective;return o().createElement("div",{className:r.productCard},t&&o().createElement("div",{className:r.vipBadge||"vipBadge"},"VIP Only"),o().createElement("img",{src:p,alt:a,className:r.productImage||"productImage"}),o().createElement("div",{className:r.productInfo||"productInfo"},o().createElement("h3",null,a),u&&o().createElement("p",{className:r.brand||"brand"},u.name),l&&o().createElement("p",{className:r.itemCode||"itemCode"},"Item Code: ",l),d&&o().createElement("p",{className:r.description||"description"},d),i&&o().createElement("p",{className:r.rating||"rating"},"Rating: ",i,"/5"),m&&o().createElement("p",{className:r.price||"price"},m.currency_symbol,m.min),t&&o().createElement("p",{className:r.vipMessage||"vipMessage"},"Available with VIP membership")))}const s="query($slug: String!)  {\n  product(slug: $slug) {\n    brand {\n      name\n      uid\n    }\n    color\n    item_code\n    item_type\n    uid\n    media {\n      alt\n      type\n      url\n    }\n    name\n    price {\n      effective {\n        currency_code\n        currency_symbol\n        max\n        min\n      }\n      marked {\n        currency_code\n        currency_symbol\n        max\n        min\n      }\n    }\n    rating\n    rating_count\n    short_description\n    slug\n  }\n}";function l({title:e="VIP Products"}){const t=(0,n.useFPI)(),a=t.store.getState();console.log("state draft benefits 3",a,t.getters.THEME(a)),useGlobalStore(t.getters.LOGGED_IN);const[l,i]=(0,n.useState)([]),[d,u]=(0,n.useState)(!1),[p,m]=(0,n.useState)(null),[g,f]=(0,n.useState)(!0),[h,y]=(0,n.useState)(null),E=t.getters.THEME(a)?.application_id||"683178a4b531714af0e04a53",v=t.getters.THEME(a)?.company_id||"10253",b=useGlobalStore(t.getters.USER_DATA)?.user_id||"682c158a3d88c46a01efac53",P=async e=>{try{console.log(`Fetching details for item code: ${e}`);const a={slug:e},n=await t.executeGQL(s,a);return n?.data?.product?(console.log(`Product details for ${e}:`,n.data.product),n.data.product):(console.warn(`No product found for item code: ${e}`),null)}catch(t){return console.error(`Error fetching details for product ${e}:`,t),null}};return(0,n.useEffect)((()=>{(async()=>{try{f(!0),y(null),console.log("Fetching campaign data...");const e=await(async()=>{try{const e=await fetch(`https://fetch-db-data-d9ca324b.serverless.boltic.app?companyId=${v}&queryType=validate&applicationId=${E}&module=campaigns`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to fetch campaign data");const t=await e.json();return console.log("Campaign data:",t),t}catch(e){throw console.error("Error fetching campaign data:",e),e}})();if(e.success&&e.data.length>0){const t=e.data.filter((e=>(e=>{const t=new Date,a=new Date(e.startDate),n=new Date(e.endDate);return t>=a&&t<=n})(e)));if(t.length>0){console.log("Active campaigns found:",t);const e=t[0];if(m(e),e.products&&e.products.length>0){console.log("VIP Product item codes:",e.products.map((e=>e.item_code)));const t=await(async e=>{const t=[];for(const a of e)if(a.item_code){const e=await P(a.item_code);e&&t.push(e)}return t})(e.products);i(t)}console.log("Validating VIP user...");const a=await(async()=>{try{const e=await fetch(`https://fetch-db-data-d9ca324b.serverless.boltic.app?module=users&companyId=${v}&queryType=validate&id=${b}&applicationId=${E}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to validate VIP user");const t=await e.json();return console.log("VIP user validation:",t),t}catch(e){throw console.error("Error validating VIP user:",e),e}})();a.success&&a.data&&a.data.length>0?(console.log("VIP user validation successful:",a.data),u(!0)):(console.log("User is not a VIP member"),u(!1))}else console.log("No active campaigns found"),m(null)}else console.log("No campaigns found"),m(null)}catch(e){console.error("Error in VIP validation process:",e),y(e.message)}finally{f(!1)}})()}),[]),g?o().createElement("h2",null,"Loading products..."):h?o().createElement("h2",null,"Error: ",h):l.length?o().createElement("div",null,o().createElement(n.Helmet,null,o().createElement("title",null,e)),o().createElement("h1",null,"VIP Products"),!d&&p&&o().createElement("div",{className:r.vipMessage||""},o().createElement("p",null,"These products will be available once you buy the membership.")),o().createElement("div",{className:r.container},l.map((e=>(console.log("Product item code:",e.item_code||"No item code available"),o().createElement(c,{product:e,key:e.slug||e.item_code,isVipOnly:!d})))))):o().createElement("h2",null,"No VIP Products Found")}l.serverFetch=({fpi:e})=>Promise.resolve();const i={label:"VIP Page Products Section",name:"vip-page-products-section",props:[{id:"title",label:"Page Title",type:"text",default:"VIP Products",info:"Set the page title for the product list."}],blocks:[]},d={"vip-page-products-section":{...a}};exports.sections=t})();