!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("React"),require("helmetModule"),require("sharedUtilsLibrary")):"function"==typeof define&&define.amd?define("extension",["React","helmetModule","sharedUtilsLibrary"],t):"object"==typeof exports?exports.extension=t(require("React"),require("helmetModule"),require("sharedUtilsLibrary")):e.extension=t(e.React,e.helmetModule,e.sharedUtilsLibrary)}("undefined"!=typeof self?self:this,((e,t,a)=>(()=>{"use strict";var o={173:e=>{e.exports=a},333:e=>{e.exports=t},883:t=>{t.exports=e}},n={};function r(e){var t=n[e];if(void 0!==t)return t.exports;var a=n[e]={exports:{}};return o[e](a,a.exports,r),a.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var c={};r.r(c),r.d(c,{default:()=>y});var s={};r.r(s),r.d(s,{Component:()=>f,GET_PRODUCT_DETAILS:()=>g,settings:()=>h});var l=r(883),i=r.n(l),d=r(173),u=r(333);const p={product:"gONOQ",container:"aQaT4"};function m({product:e,isVipOnly:t}){const{name:a,slug:o,media:n,price:r,item_code:c,rating:s,short_description:l,brand:d}=e,u=n&&n.length>0?n[0].url:"",m=r?.effective;return i().createElement("div",{className:p.productCard},t&&i().createElement("div",{className:p.vipBadge||"vipBadge"},"VIP Only"),i().createElement("img",{src:u,alt:a,className:p.productImage||"productImage"}),i().createElement("div",{className:p.productInfo||"productInfo"},i().createElement("h3",null,a),d&&i().createElement("p",{className:p.brand||"brand"},d.name),c&&i().createElement("p",{className:p.itemCode||"itemCode"},"Item Code: ",c),l&&i().createElement("p",{className:p.description||"description"},l),s&&i().createElement("p",{className:p.rating||"rating"},"Rating: ",s,"/5"),m&&i().createElement("p",{className:p.price||"price"},m.currency_symbol,m.min),t&&i().createElement("p",{className:p.vipMessage||"vipMessage"},"Available with VIP membership")))}const g="query($slug: String!)  {\n  product(slug: $slug) {\n    brand {\n      name\n      uid\n    }\n    color\n    item_code\n    item_type\n    uid\n    media {\n      alt\n      type\n      url\n    }\n    name\n    price {\n      effective {\n        currency_code\n        currency_symbol\n        max\n        min\n      }\n      marked {\n        currency_code\n        currency_symbol\n        max\n        min\n      }\n    }\n    rating\n    rating_count\n    short_description\n    slug\n  }\n}";function f({title:e="VIP Products"}){const t=(0,d.useFPI)(),a=t.store.getState();console.log("state draft benefits 3",a,t.getters.THEME(a)),useGlobalStore(t.getters.LOGGED_IN);const[o,n]=(0,l.useState)([]),[r,c]=(0,l.useState)(!1),[s,f]=(0,l.useState)(null),[h,y]=(0,l.useState)(!0),[b,v]=(0,l.useState)(null),E=t.getters.THEME(a)?.application_id||"683178a4b531714af0e04a53",P=t.getters.THEME(a)?.company_id||"10253",I=useGlobalStore(t.getters.USER_DATA)?.user_id||"682c158a3d88c46a01efac53",_=async e=>{try{console.log(`Fetching details for item code: ${e}`);const a={slug:e},o=await t.executeGQL(g,a);return o?.data?.product?(console.log(`Product details for ${e}:`,o.data.product),o.data.product):(console.warn(`No product found for item code: ${e}`),null)}catch(t){return console.error(`Error fetching details for product ${e}:`,t),null}};return(0,l.useEffect)((()=>{(async()=>{try{y(!0),v(null),console.log("Fetching campaign data...");const e=await(async()=>{try{const e=await fetch(`https://fetch-db-data-d9ca324b.serverless.boltic.app?companyId=${P}&queryType=validate&applicationId=${E}&module=campaigns`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to fetch campaign data");const t=await e.json();return console.log("Campaign data:",t),t}catch(e){throw console.error("Error fetching campaign data:",e),e}})();if(e.success&&e.data.length>0){const t=e.data.filter((e=>(e=>{const t=new Date,a=new Date(e.startDate),o=new Date(e.endDate);return t>=a&&t<=o})(e)));if(t.length>0){console.log("Active campaigns found:",t);const e=t[0];if(f(e),e.products&&e.products.length>0){console.log("VIP Product item codes:",e.products.map((e=>e.item_code)));const t=await(async e=>{const t=[];for(const a of e)if(a.item_code){const e=await _(a.item_code);e&&t.push(e)}return t})(e.products);n(t)}console.log("Validating VIP user...");const a=await(async()=>{try{const e=await fetch(`https://fetch-db-data-d9ca324b.serverless.boltic.app?module=users&companyId=${P}&queryType=validate&id=${I}&applicationId=${E}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to validate VIP user");const t=await e.json();return console.log("VIP user validation:",t),t}catch(e){throw console.error("Error validating VIP user:",e),e}})();a.success&&a.data&&a.data.length>0?(console.log("VIP user validation successful:",a.data),c(!0)):(console.log("User is not a VIP member"),c(!1))}else console.log("No active campaigns found"),f(null)}else console.log("No campaigns found"),f(null)}catch(e){console.error("Error in VIP validation process:",e),v(e.message)}finally{y(!1)}})()}),[]),h?i().createElement("h2",null,"Loading products..."):b?i().createElement("h2",null,"Error: ",b):o.length?i().createElement("div",null,i().createElement(u.Helmet,null,i().createElement("title",null,e)),i().createElement("h1",null,"VIP Products"),!r&&s&&i().createElement("div",{className:p.vipMessage||""},i().createElement("p",null,"These products will be available once you buy the membership.")),i().createElement("div",{className:p.container},o.map((e=>(console.log("Product item code:",e.item_code||"No item code available"),i().createElement(m,{product:e,key:e.slug||e.item_code,isVipOnly:!r})))))):i().createElement("h2",null,"No VIP Products Found")}f.serverFetch=({fpi:e})=>Promise.resolve();const h={label:"VIP Page Products Section",name:"vip-page-products-section",props:[{id:"title",label:"Page Title",type:"text",default:"VIP Products",info:"Set the page title for the product list."}],blocks:[]},y={"vip-page-products-section":{...s}};return c})()));