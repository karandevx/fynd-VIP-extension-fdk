!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("React"),require("sharedUtilsLibrary")):"function"==typeof define&&define.amd?define("extension",["React","sharedUtilsLibrary"],e):"object"==typeof exports?exports.extension=e(require("React"),require("sharedUtilsLibrary")):t.extension=e(t.React,t.sharedUtilsLibrary)}("undefined"!=typeof self?self:this,((t,e)=>(()=>{"use strict";var o={173:t=>{t.exports=e},883:e=>{e.exports=t}},n={};function r(t){var e=n[t];if(void 0!==e)return e.exports;var a=n[t]={exports:{}};return o[t](a,a.exports,r),a.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var o in e)r.o(e,o)&&!r.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var a={};r.r(a),r.d(a,{default:()=>u});var i={};r.r(i),r.d(i,{Component:()=>p,settings:()=>d});var s=r(883),c=r.n(s),l=r(173);function p({props:t}){console.log(": VIP PLP Protection Component 2");const e=(0,l.useFPI)(),o=e.store.getState(),[n,r]=(0,s.useState)(null),[a,i]=(0,s.useState)(null),[p,d]=(0,s.useState)(!0),[u,m]=(0,s.useState)(null),[g,f]=(0,s.useState)(null),b=e.getters.THEME(o)?.application_id,h=e.getters.THEME(o)?.company_id,v=h||"10253",y=b||"6828309ae4f8062f0c847089",x=(0,l.useGlobalStore)(e.getters.PAGE),w=(0,l.useGlobalStore)(e?.getters?.PRODUCTS),P=(0,l.useGlobalStore)(e.getters.USER_DATA)?.user_id||"683817d98fbf32007a149c91";console.log("pageDetails",x),console.log("productsListData>>>",w);const E=(t,e)=>{console.log("Processing product listing...",{campaignProductCodes:t,isVipUser:e});const o=document.querySelector(".product-listing__productContainer___oyoni");if(!o)return void console.log("Product listing container not found");const n=o.querySelectorAll('a[href*="/product/"]');console.log(`Found ${n.length} product links`),n.forEach(((o,n)=>{const r=o.getAttribute("href");console.log("Processing link:",r);const a=(t=>{try{console.log("Extracting item code from slug:",t,w);const e=t.split("/product/")[1]?.split("-")[0];if(console.log("Slug:",e),!e||!w?.items)return null;const o=w.items.find((t=>t.slug?.toLowerCase()===e?.toLowerCase()));return console.log("Matching product:",o),o?.item_code||e}catch(t){return console.error("Error extracting item code from slug:",t),null}})(r);if(console.log(`Processing product ${n+1}:`,{href:r,itemCode:a}),a){const n=`product-${a.toLowerCase().replace(/[^a-z0-9]/g,"-")}`;o.id=n;const r=t.has(a.toLowerCase());if(console.log(`Product ${a}:`,{isVipProduct:r,isVipUser:e}),r&&!e){console.log(`Blocking access to VIP product: ${a}`),o.classList.add("vip-product-disabled");const t=document.createElement("div");t.className="vip-overlay",t.innerHTML='\n         <div class="vip-badge">VIP EXCLUSIVE</div>\n         <div class="vip-message">Upgrade to VIP to unlock this product</div>\n       ',o.appendChild(t),o.addEventListener("click",(t=>{t.preventDefault(),t.stopPropagation(),alert("This product is exclusive to VIP members only!")}))}else{o.classList.remove("vip-product-disabled");const t=o.querySelector(".vip-overlay");t&&t.remove()}}}))},S=(t,e)=>{const o=window.location.pathname;console.log("Route change detected:",o),(o.includes("/products")||o.includes("/collections")||o.includes("/category")||"/"===o)&&setTimeout((()=>{E(t,e)}),500)};return(0,s.useEffect)((()=>((async()=>{try{d(!0),m(null),(()=>{console.log("adding vip styles");const t=document.createElement("style");t.id="vip-protection-styles",t.textContent='\n   .vip-overlay {\n     position: absolute !important;\n     top: 0 !important;\n     left: 0 !important;\n     right: 0 !important;\n     bottom: 0 !important;\n     background: linear-gradient(135deg, rgba(139, 69, 19, 0.95), rgba(255, 215, 0, 0.85)) !important;\n     color: white !important;\n     display: flex !important;\n     flex-direction: column !important;\n     align-items: center !important;\n     justify-content: center !important;\n     font-weight: bold !important;\n     z-index: 10 !important;\n     border-radius: 8px !important;\n     text-align: center !important;\n     backdrop-filter: blur(2px) !important;\n     border: 2px solid #FFD700 !important;\n     box-shadow: 0 8px 32px rgba(255, 215, 0, 0.3) !important;\n   }\n \n   .vip-overlay::before {\n     content: "ðŸ‘‘" !important;\n     font-size: 28px !important;\n     margin-bottom: 8px !important;\n     animation: vip-glow 2s ease-in-out infinite alternate !important;\n   }\n \n   .vip-overlay .vip-badge {\n     background: linear-gradient(45deg, #FFD700, #FFA500, #FFD700) !important;\n     background-size: 200% 200% !important;\n     animation: vip-shimmer 3s ease-in-out infinite !important;\n     color: #8B4513 !important;\n     padding: 8px 20px !important;\n     border-radius: 25px !important;\n     font-size: 13px !important;\n     font-weight: 700 !important;\n     letter-spacing: 1.5px !important;\n     text-transform: uppercase !important;\n     box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4) !important;\n     border: 2px solid #8B4513 !important;\n     text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2) !important;\n     margin-bottom: 6px !important;\n   }\n \n   .vip-overlay .vip-message {\n     font-size: 11px !important;\n     font-weight: 500 !important;\n     color: #FFF8DC !important;\n     text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5) !important;\n     margin-top: 4px !important;\n     opacity: 0.9 !important;\n   }\n \n   @keyframes vip-glow {\n     0% { text-shadow: 0 0 5px #FFD700, 0 0 10px #FFD700, 0 0 15px #FFD700; }\n     100% { text-shadow: 0 0 10px #FFD700, 0 0 20px #FFD700, 0 0 30px #FFD700; }\n   }\n \n   @keyframes vip-shimmer {\n     0% { background-position: 0% 50%; }\n     50% { background-position: 100% 50%; }\n     100% { background-position: 0% 50%; }\n   }\n \n   .vip-product-disabled {\n    position: relative !important;\n     pointer-events: none !important;\n     opacity: 0.8 !important;\n     filter: grayscale(0.2) !important;\n     transition: all 0.3s ease !important;\n   }\n \n   .vip-cart-disabled {\n     background: linear-gradient(45deg, #cccccc, #b8b8b8) !important;\n     color: #666666 !important;\n     cursor: not-allowed !important;\n     border: 1px solid #cccccc !important;\n     opacity: 0.7 !important;\n     font-weight: 600 !important;\n     text-transform: uppercase !important;\n     letter-spacing: 0.5px !important;\n   }\n \n   .vip-cart-disabled:hover {\n     background: linear-gradient(45deg, #cccccc, #b8b8b8) !important;\n     color: #666666 !important;\n     transform: none !important;\n   }\n ',document.head.appendChild(t)})(),console.log("Fetching campaign data...");const t=await(async()=>{try{const t=await fetch(`https://fetch-db-data-d9ca324b.serverless.boltic.app?companyId=${v}&module=campaigns`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error("Failed to fetch campaign data");return await t.json()}catch(t){throw console.error("Error fetching campaign data:",t),t}})();if(t.success&&t.data.length>0){const e=t.data.filter((t=>(t=>{const e=new Date,o=new Date(t.startDate),n=new Date(t.endDate);return e>=o&&e<=n})(t)));if(e.length>0){console.log("Active campaigns found:",e);const t=e[0];r(t),console.log("Validating VIP user...");const o=await(async()=>{try{const t=await fetch(`https://fetch-db-data-d9ca324b.serverless.boltic.app?module=users&companyId=${v}&queryType=validate&id=${P}&applicationId=${y}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error("Failed to validate VIP user");return await t.json()}catch(t){throw console.error("Error validating VIP user:",t),t}})();let n=!1;o.success&&o.data&&o.data.length>0?(console.log("VIP user validation successful:",o.data),i(o.data[0]),n=!0):(console.log("VIP user validation failed - user is not VIP"),i(null),n=!1);const a=new Set(t.products.map((t=>t.item_code?.toLowerCase())));console.log("Campaign product codes:",a),console.log("Is VIP user:",n),S(a,n);const s=((t,e)=>{console.log("Setting up mutation observer...");const o=document.getElementById("fixed-plp-id");if(!o)return console.log("Container not found for mutation observer"),null;const n=new MutationObserver((o=>{let n=!1;o.forEach((t=>{"childList"===t.type&&t.addedNodes.length>0&&t.addedNodes.forEach((t=>{1===t.nodeType&&t.querySelector&&(t.querySelector('a[href*="/product/"]')||t.matches&&t.matches('a[href*="/product/"]'))&&(n=!0)}))})),n&&(console.log("New products detected, reprocessing..."),setTimeout((()=>{E(t,e)}),100))}));return n.observe(o,{childList:!0,subtree:!0}),n})(a,n);f(s);const c=history.pushState,l=history.replaceState;history.pushState=function(...t){c.apply(this,t),setTimeout((()=>S(a,n)),100)},history.replaceState=function(...t){l.apply(this,t),setTimeout((()=>S(a,n)),100)},window.addEventListener("popstate",(()=>{setTimeout((()=>S(a,n)),100)}))}else console.log("No active campaigns found"),r(null)}else console.log("No campaigns found"),r(null)}catch(t){console.error("Error in VIP PLP protection process:",t),m(t.message)}finally{d(!1)}})(),()=>{g&&g.disconnect()})),[w,x]),(0,s.useEffect)((()=>{if(n&&void 0!==a){const t=new Set(activeCampaign[0].products.map((t=>t.item_code?.toLowerCase()))),e=null!==a;setTimeout((()=>{E(t,e)}),100)}}),[w]),p?c().createElement("div",{style:{display:"none"}}):(u&&console.error("VIP PLP Protection Error:",u),c().createElement(c().Fragment,null))}const d={label:"VIP PLP",name:"vip-plp-section",props:[{id:"title",label:"Page Title",type:"text",default:"Extension Title",info:"Page Title"}],blocks:[]},u={"vip-plp-section":{...i}};return a})()));