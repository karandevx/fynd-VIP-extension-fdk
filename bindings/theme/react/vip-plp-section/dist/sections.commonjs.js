(()=>{"use strict";var t={n:e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return t.d(o,{a:o}),o},d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{default:()=>s});var o={};t.r(o),t.d(o,{Component:()=>a,settings:()=>i});const n=require("fs");var r=t.n(n);function a({props:t}){console.log(": VIP PLP Protection Component 1");const e=(0,n.useFPI)(),[o,a]=(0,n.useState)(null),[i,s]=(0,n.useState)(null),[c,l]=(0,n.useState)(!0),[p,d]=(0,n.useState)(null),[u,m]=(0,n.useState)(null),g=(0,n.useGlobalStore)(e.getters.PAGE),f=(0,n.useGlobalStore)(e?.getters?.PRODUCTS),b="10253";console.log("pageDetails",g),console.log("productsListData>>>",f);const v=(t,e)=>{console.log("Processing product listing...",{campaignProductCodes:t,isVipUser:e});const o=document.querySelector(".product-listing__productContainer___oyoni");if(!o)return void console.log("Product listing container not found");const n=o.querySelectorAll('a[href*="/product/"]');console.log(`Found ${n.length} product links`),n.forEach(((o,n)=>{const r=o.getAttribute("href");console.log("Processing link:",r);const a=(t=>{try{console.log("Extracting item code from slug:",t,f);const e=t.split("/product/")[1]?.split("-")[0];if(console.log("Slug:",e),!e||!f?.items)return null;const o=f.items.find((t=>t.slug?.toLowerCase()===e?.toLowerCase()));return console.log("Matching product:",o),o?.item_code||e}catch(t){return console.error("Error extracting item code from slug:",t),null}})(r);if(console.log(`Processing product ${n+1}:`,{href:r,itemCode:a}),a){const n=`product-${a.toLowerCase().replace(/[^a-z0-9]/g,"-")}`;o.id=n;const r=t.has(a.toLowerCase());if(console.log(`Product ${a}:`,{isVipProduct:r,isVipUser:e}),r&&!e){console.log(`Blocking access to VIP product: ${a}`),o.classList.add("vip-product-disabled"),o.addEventListener("click",(t=>{t.preventDefault(),t.stopPropagation(),alert("This product is exclusive to VIP members only!")}));const t=o.querySelector('.product-card__addToCart___KUnfH, button[aria-label*="cart"], button:contains("ADD TO CART")');t&&(t.disabled=!0,t.classList.add("vip-cart-disabled"),t.innerHTML="<span>VIP ONLY</span>",t.addEventListener("click",(t=>{t.preventDefault(),t.stopPropagation(),alert("This product is exclusive to VIP members only!")})));const e=o.querySelector(".product-card__productCard___VMIjd");if(e&&!e.querySelector(".vip-overlay")){"static"===window.getComputedStyle(e).position&&(e.style.position="relative");const t=document.createElement("div");t.className="vip-overlay",t.innerHTML='\n           <div class="vip-badge">VIP EXCLUSIVE</div>\n           <div class="vip-message">Upgrade to VIP to unlock this product</div>\n         ',e.appendChild(t)}}else{o.classList.remove("vip-product-disabled");const t=o.querySelector(".vip-overlay");t&&t.remove()}}}))},h=(t,e)=>{const o=window.location.pathname;console.log("Route change detected:",o),(o.includes("/products")||o.includes("/collections")||o.includes("/category")||"/"===o)&&setTimeout((()=>{v(t,e)}),500)};return(0,n.useEffect)((()=>((async()=>{try{l(!0),d(null),(()=>{console.log("adding vip styles");const t=document.createElement("style");t.id="vip-protection-styles",t.textContent='\n   .vip-overlay {\n     position: absolute !important;\n     top: 0 !important;\n     left: 0 !important;\n     right: 0 !important;\n     bottom: 0 !important;\n     background: linear-gradient(135deg, rgba(139, 69, 19, 0.95), rgba(255, 215, 0, 0.85)) !important;\n     color: white !important;\n     display: flex !important;\n     flex-direction: column !important;\n     align-items: center !important;\n     justify-content: center !important;\n     font-weight: bold !important;\n     z-index: 10 !important;\n     border-radius: 8px !important;\n     text-align: center !important;\n     backdrop-filter: blur(2px) !important;\n     border: 2px solid #FFD700 !important;\n     box-shadow: 0 8px 32px rgba(255, 215, 0, 0.3) !important;\n   }\n \n   .vip-overlay::before {\n     content: "ðŸ‘‘" !important;\n     font-size: 28px !important;\n     margin-bottom: 8px !important;\n     animation: vip-glow 2s ease-in-out infinite alternate !important;\n   }\n \n   .vip-overlay .vip-badge {\n     background: linear-gradient(45deg, #FFD700, #FFA500, #FFD700) !important;\n     background-size: 200% 200% !important;\n     animation: vip-shimmer 3s ease-in-out infinite !important;\n     color: #8B4513 !important;\n     padding: 8px 20px !important;\n     border-radius: 25px !important;\n     font-size: 13px !important;\n     font-weight: 700 !important;\n     letter-spacing: 1.5px !important;\n     text-transform: uppercase !important;\n     box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4) !important;\n     border: 2px solid #8B4513 !important;\n     text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2) !important;\n     margin-bottom: 6px !important;\n   }\n \n   .vip-overlay .vip-message {\n     font-size: 11px !important;\n     font-weight: 500 !important;\n     color: #FFF8DC !important;\n     text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5) !important;\n     margin-top: 4px !important;\n     opacity: 0.9 !important;\n   }\n \n   @keyframes vip-glow {\n     0% { text-shadow: 0 0 5px #FFD700, 0 0 10px #FFD700, 0 0 15px #FFD700; }\n     100% { text-shadow: 0 0 10px #FFD700, 0 0 20px #FFD700, 0 0 30px #FFD700; }\n   }\n \n   @keyframes vip-shimmer {\n     0% { background-position: 0% 50%; }\n     50% { background-position: 100% 50%; }\n     100% { background-position: 0% 50%; }\n   }\n \n   .vip-product-disabled {\n     pointer-events: none !important;\n     opacity: 0.8 !important;\n     filter: grayscale(0.2) !important;\n     transition: all 0.3s ease !important;\n   }\n \n   .vip-cart-disabled {\n     background: linear-gradient(45deg, #cccccc, #b8b8b8) !important;\n     color: #666666 !important;\n     cursor: not-allowed !important;\n     border: 1px solid #cccccc !important;\n     opacity: 0.7 !important;\n     font-weight: 600 !important;\n     text-transform: uppercase !important;\n     letter-spacing: 0.5px !important;\n   }\n \n   .vip-cart-disabled:hover {\n     background: linear-gradient(45deg, #cccccc, #b8b8b8) !important;\n     color: #666666 !important;\n     transform: none !important;\n   }\n ',document.head.appendChild(t)})(),console.log("Fetching campaign data...");const t=await(async()=>{try{const t=await fetch(`https://fetch-db-data-d9ca324b.serverless.boltic.app?companyId=${b}&module=campaigns`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error("Failed to fetch campaign data");return await t.json()}catch(t){throw console.error("Error fetching campaign data:",t),t}})();if(t.success&&t.data.length>0){const e=t.data.filter((t=>(t=>{const e=new Date,o=new Date(t.startDate),n=new Date(t.endDate);return e>=o&&e<=n})(t)));if(e.length>0){console.log("Active campaigns found:",e);const t=e[0];a(t),console.log("Validating VIP user...");const o=await(async()=>{try{const t=await fetch(`https://fetch-db-data-d9ca324b.serverless.boltic.app?module=users&companyId=${b}&queryType=validate&id=683817d98fbf32007a149c91&applicationId=6838178d9fdd289461be895e`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error("Failed to validate VIP user");return await t.json()}catch(t){throw console.error("Error validating VIP user:",t),t}})();let n=!1;o.success&&o.data&&o.data.length>0?(console.log("VIP user validation successful:",o.data),s(o.data[0]),n=!0):(console.log("VIP user validation failed - user is not VIP"),s(null),n=!1);const r=new Set([{item_code:"marv5rue_KD"}].map((t=>t.item_code?.toLowerCase())));console.log("Campaign product codes:",r),console.log("Is VIP user:",n),h(r,n);const i=((t,e)=>{console.log("Setting up mutation observer...");const o=document.querySelector(".product-listing__productContainer___oyoni");if(!o)return console.log("Container not found for mutation observer"),null;const n=new MutationObserver((o=>{let n=!1;o.forEach((t=>{"childList"===t.type&&t.addedNodes.length>0&&t.addedNodes.forEach((t=>{1===t.nodeType&&t.querySelector&&(t.querySelector('a[href*="/product/"]')||t.matches&&t.matches('a[href*="/product/"]'))&&(n=!0)}))})),n&&(console.log("New products detected, reprocessing..."),setTimeout((()=>{v(t,e)}),100))}));return n.observe(o,{childList:!0,subtree:!0}),n})(r,n);m(i);const c=history.pushState,l=history.replaceState;history.pushState=function(...t){c.apply(this,t),setTimeout((()=>h(r,n)),100)},history.replaceState=function(...t){l.apply(this,t),setTimeout((()=>h(r,n)),100)},window.addEventListener("popstate",(()=>{setTimeout((()=>h(r,n)),100)}))}else console.log("No active campaigns found"),a(null)}else console.log("No campaigns found"),a(null)}catch(t){console.error("Error in VIP PLP protection process:",t),d(t.message)}finally{l(!1)}})(),()=>{u&&u.disconnect()})),[f,g]),(0,n.useEffect)((()=>{if(o&&void 0!==i){const t=new Set([{item_code:"marv5rue_KD"}].map((t=>t.item_code?.toLowerCase()))),e=null!==i;setTimeout((()=>{v(t,e)}),100)}}),[f]),c?r().createElement("div",{style:{display:"none"}}):(p&&console.error("VIP PLP Protection Error:",p),r().createElement(r().Fragment,null))}const i={label:"VIP PLP",name:"vip-plp-section",props:[{id:"title",label:"Page Title",type:"text",default:"Extension Title",info:"Page Title"}],blocks:[]},s={"vip-plp-section":{...o}};exports.sections=e})();