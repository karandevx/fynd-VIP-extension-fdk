!function(n,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("React"),require("ReactRouterDOM"),require("helmetModule"),require("sharedUtilsLibrary")):"function"==typeof define&&define.amd?define("extension",["React","ReactRouterDOM","helmetModule","sharedUtilsLibrary"],e):"object"==typeof exports?exports.extension=e(require("React"),require("ReactRouterDOM"),require("helmetModule"),require("sharedUtilsLibrary")):n.extension=e(n.React,n.ReactRouterDOM,n.helmetModule,n.sharedUtilsLibrary)}("undefined"!=typeof self?self:this,((n,e,t,o)=>(()=>{"use strict";var a={173:n=>{n.exports=o},333:n=>{n.exports=t},854:n=>{n.exports=e},883:e=>{e.exports=n}},i={};function r(n){var e=i[n];if(void 0!==e)return e.exports;var t=i[n]={exports:{}};return a[n](t,t.exports,r),t.exports}r.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return r.d(e,{a:e}),e},r.d=(n,e)=>{for(var t in e)r.o(e,t)&&!r.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},r.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),r.r=n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};var c={};r.r(c),r.d(c,{default:()=>f});var s={};r.r(s),r.d(s,{Component:()=>y,settings:()=>g});var u=r(883),l=r.n(u),d=r(173);r(333);var p=r(854);const _="mutation UpdateCart($areaCode: String, $b: Boolean, $buyNow: Boolean, $i: Boolean, $updateCartId: String, $updateCartRequestInput: UpdateCartRequestInput, $cartType: String) {\n  updateCart(areaCode: $areaCode, b: $b, buyNow: $buyNow, i: $i, id: $updateCartId, updateCartRequestInput: $updateCartRequestInput, cartType: $cartType) {\n      message\n      success\n      cart {\n        buy_now\n        cart_id\n        checkout_mode\n        comment\n        coupon_text\n        delivery_charge_info\n        gstin\n        id\n        is_valid\n        last_modified\n        message\n        pan_config\n        pan_no\n        restrict_checkout\n        uid\n        breakup_values {\n          coupon {\n            code\n            coupon_type\n            coupon_value\n            description\n            is_applied\n            message\n            minimum_cart_value\n            sub_title\n            title\n            type\n            uid\n            value\n          }\n          display {\n            currency_code\n            currency_symbol\n            display\n            key\n            message\n            value\n            preset\n          }\n          loyalty_points {\n            applicable\n            description\n            is_applied\n            total\n          }\n        }\n        delivery_promise {\n          formatted {\n            max\n            min\n          }\n          timestamp {\n            max\n            min\n          }\n        }\n        coupon {\n          cashback_amount\n          cashback_message_primary\n          cashback_message_secondary\n          coupon_code\n          coupon_description\n          coupon_id\n          coupon_subtitle\n          coupon_title\n          coupon_type\n          coupon_value\n          discount\n          is_applied\n          is_valid\n          message\n          minimum_cart_value\n        }\n        applied_promo_details {\n          amount\n          article_quantity\n          code\n          meta\n          mrp_promotion\n          offer_text\n          promo_id\n          promotion_group\n          promotion_name\n          promotion_type\n          applied_free_articles {\n            article_id\n            parent_item_identifier\n            quantity\n          }\n        }\n        currency {\n          code\n          symbol\n        }\n        items {\n          bulk_offer\n          coupon_message\n          custom_order\n          discount\n          is_set\n          key\n          message\n          moq\n          parent_item_identifiers\n          product_ean_id\n          quantity\n          article {\n            _custom_json\n            cart_item_meta\n            extra_meta\n            gift_card\n            identifier\n            is_gift_visible\n            meta\n            mto_quantity\n            parent_item_identifiers\n            product_group_tags\n            quantity\n            seller_identifier\n            size\n            tags\n            type\n            uid\n            seller {\n              name\n              uid\n            }\n            price {\n              base {\n                currency_code\n                currency_symbol\n                effective\n                marked\n              }\n              converted {\n                currency_code\n                currency_symbol\n                effective\n                marked\n              }\n            }\n          }\n          coupon {\n            code\n            discount_single_quantity\n            discount_total_quantity\n          }\n          charges {\n            meta\n            name\n            allow_refund\n            code\n            type\n            amount {\n              currency\n              value\n            }\n          }\n          identifiers {\n            identifier\n          }\n          delivery_promise {\n            formatted {\n              max\n              min\n            }\n            timestamp {\n              max\n              min\n            }\n            iso {\n              max\n              min\n            }\n          }\n          availability {\n            deliverable\n            is_valid\n            other_store_quantity\n            out_of_stock\n            sizes\n            available_sizes {\n              display\n              is_available\n              value\n            }\n          }\n          price {\n            base {\n              currency_code\n              currency_symbol\n              effective\n              marked\n            }\n            converted {\n              currency_code\n              currency_symbol\n              effective\n              marked\n            }\n          }\n          price_per_unit {\n            base {\n              currency_code\n              currency_symbol\n              effective\n              marked\n              selling_price\n            }\n          }\n          product {\n            _custom_json\n            attributes\n            item_code\n            name\n            slug\n            tags\n            type\n            uid\n            action {\n              type\n              url\n              query {\n                product_slug\n              }\n            }\n            brand {\n              name\n              uid\n            }\n            categories {\n              name\n              uid\n            }\n            images {\n              aspect_ratio\n              secure_url\n              url\n            }\n          }\n          promo_meta {\n            message\n          }\n        }\n      }\n  }\n}",m="query Cart($areaCode: String, $assignCardId: Int, $includeBreakup: Boolean, $buyNow: Boolean, $includeAllItems: Boolean, $includeCodCharges: Boolean, $cartId: String) {\n  cart(areaCode: $areaCode, assignCardId: $assignCardId, includeBreakup: $includeBreakup, buyNow: $buyNow, includeAllItems: $includeAllItems, includeCodCharges: $includeCodCharges, id: $cartId) {\n    buy_now\n    cart_id\n    checkout_mode\n    comment\n    coupon_text\n    delivery_charge_info\n    gstin\n    id\n    is_valid\n    message\n    restrict_checkout\n    user_cart_items_count\n    uid\n    items {\n      bulk_offer\n      coupon_message\n      custom_order\n      discount\n      is_set\n      key\n      message\n      moq\n      parent_item_identifiers\n      product_ean_id\n      quantity\n      availability {\n        deliverable\n        is_valid\n        other_store_quantity\n        out_of_stock\n        sizes\n        available_sizes {\n          display\n          is_available\n          value\n        }\n      }\n      article {\n        _custom_json\n        cart_item_meta\n        extra_meta\n        gift_card\n        identifier\n        is_gift_visible\n        meta\n        mto_quantity\n        parent_item_identifiers\n        product_group_tags\n        quantity\n        seller_identifier\n        size\n        tags\n        uid\n        seller {\n          name\n          uid\n        }\n        price {\n          base {\n            currency_code\n            currency_symbol\n            effective\n            marked\n          }\n          converted {\n            currency_code\n            currency_symbol\n            effective\n            marked\n          }\n        }\n      }\n      price_per_unit {\n        base {\n          currency_code\n          currency_symbol\n          effective\n          marked\n          selling_price\n        }\n        converted {\n          currency_code\n          currency_symbol\n          effective\n          marked\n          selling_price\n        }\n      }\n      product {\n        _custom_json\n        attributes\n        item_code\n        name\n        slug\n        tags\n        type\n        uid\n        brand {\n          name\n          uid\n        }\n        action {\n          type\n          url\n        }\n        categories {\n          name\n          uid\n        }\n        images {\n          aspect_ratio\n          secure_url\n          url\n        }\n      }\n      promo_meta {\n        message\n      }\n      promotions_applied {\n        amount\n        article_quantity\n        code\n        meta\n        mrp_promotion\n        offer_text\n        promo_id\n        promotion_group\n        promotion_name\n        promotion_type\n        applied_free_articles {\n          article_id\n          parent_item_identifier\n          quantity\n        }\n        discount_rules {\n          item_criteria\n          matched_buy_rules\n          offer\n          raw_offer\n        }\n      }\n      charges {\n        meta\n        name\n        allow_refund\n        code\n        type\n        amount {\n          currency\n          value\n        }\n      }\n      coupon {\n        code\n        discount_single_quantity\n        discount_total_quantity\n      }\n      identifiers {\n        identifier\n      }\n      price {\n        base {\n          currency_code\n          currency_symbol\n          effective\n          marked\n        }\n        converted {\n          currency_code\n          currency_symbol\n          effective\n          marked\n        }\n      }\n      delivery_promise {\n        formatted {\n          max\n          min\n        }\n        timestamp {\n          max\n          min\n        }\n        iso {\n          max\n          min\n        }\n      }\n    }\n    breakup_values {\n      coupon {\n        code\n        coupon_type\n        coupon_value\n        description\n        is_applied\n        message\n        minimum_cart_value\n        sub_title\n        title\n        type\n        uid\n        value\n      }\n      display {\n        currency_code\n        currency_symbol\n        display\n        key\n        message\n        value\n        preset\n      }\n      loyalty_points {\n        applicable\n        description\n        is_applied\n        total\n      }\n      raw {\n        cod_charge\n        convenience_fee\n        coupon\n        delivery_charge\n        discount\n        fynd_cash\n        gift_card\n        gst_charges\n        mop_total\n        mrp_total\n        subtotal\n        total\n        vog\n        you_saved\n        total_charge\n      }\n    }\n    coupon {\n      cashback_amount\n      cashback_message_primary\n      cashback_message_secondary\n      coupon_code\n      coupon_description\n      coupon_id\n      coupon_subtitle\n      coupon_title\n      coupon_type\n      coupon_value\n      discount\n      is_applied\n      is_valid\n      message\n      minimum_cart_value\n    }\n    delivery_promise {\n      formatted {\n        max\n        min\n      }\n      timestamp {\n        max\n        min\n      }\n      iso {\n        max\n        min\n      }\n    }\n    applied_promo_details {\n      amount\n      article_quantity\n      code\n      meta\n      mrp_promotion\n      offer_text\n      promo_id\n      promotion_group\n      promotion_name\n      promotion_type\n    }\n    currency {\n      code\n      symbol\n    }\n    success\n  }\n\n  coupons {\n    available_coupon_list {\n      coupon_amount\n      coupon_applicable_message\n      coupon_code\n      coupon_type\n      coupon_value\n      description\n      end_date\n      expires_on\n      is_applicable\n      is_applied\n      is_bank_offer\n      max_discount_value\n      message\n      minimum_cart_value\n      offer_text\n      start_date\n      sub_title\n      title\n    }\n    page {\n      current\n      has_next\n      has_previous\n      total\n      total_item_count\n    }\n  }\n}\n";function y({props:n}){console.log(": drafting 8 in product validation page.");const e=(0,d.useFPI)(),t=(0,p.useNavigate)(),[o,a]=(0,u.useState)(null),[i,r]=(0,u.useState)(null),[c,s]=(0,u.useState)(!0),[y,g]=(0,u.useState)(null),[f,v]=(0,u.useState)(!1),b=(0,d.useGlobalStore)(e.getters.PAGE),h=(0,d.useGlobalStore)(e.getters.CART),C=(0,d.useGlobalStore)(e.getters.PRODUCT);console.log("PRODUCT",C);const w="10253";console.log("pageDetails",b),console.log("using fpi in vip validations",e),console.log("CART_ITEMS",h),console.log("PRODUCT hellooo",C);const k=(0,d.useGlobalStore)(e?.getters?.PRODUCTS);console.log("productsListData>>>",k);return(0,u.useEffect)((()=>{(async()=>{try{s(!0),g(null),console.log("Fetching campaign data...");const n=await(async()=>{try{const n=await fetch(`https://fetch-db-data-d9ca324b.serverless.boltic.app?companyId=${w}&module=campaigns`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!n.ok)throw new Error("Failed to fetch campaign data");return await n.json()}catch(n){throw console.error("Error fetching campaign data:",n),n}})();if(n.success&&n.data.length>0){const o=n.data.filter((n=>(n=>{const e=new Date,t=new Date(n.startDate),o=new Date(n.endDate);return e>=t&&e<=o})(n)));if(o.length>0){console.log("Active campaigns found:",o);const n=o[0];a(n),console.log("Validating VIP user...");const i=await(async()=>{try{const n=await fetch(`https://fetch-db-data-d9ca324b.serverless.boltic.app?module=users&companyId=${w}&queryType=validate&id=683817d98fbf32007a149c91&applicationId=6838178d9fdd289461be895e`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!n.ok)throw new Error("Failed to validate VIP user");return await n.json()}catch(n){throw console.error("Error validating VIP user:",n),n}})();let c=!1;i.success&&i.data&&i.data.length>0?(console.log("VIP user validation successful:",i.data),r(i.data[0]),c=!0):(console.log("VIP user validation failed - user is not VIP"),r(null),c=!1),console.log("Performing cart and product validations..."),((n,t)=>{if(!h?.cart_items?.items||!n?.products)return;const o=h.cart_items.items;console.log("activeCampaign",n);const a=new Set([{item_code:"marv5rue_KD"}].map((n=>n.item_code?.toLowerCase())));console.log("Campaign product codes:",a),console.log("Is VIP user:",t),o.forEach(((n,o)=>{const i=n?.product?.item_code?.toLowerCase();console.log("Checking cart item:",{name:n?.product?.name,item_code:i,inCampaign:a.has(i)}),i&&a.has(i)&&!t&&(console.log("Removing VIP-only item from cart:",n?.product?.name),(async(n,t,o)=>{try{v(!0);const a={b:!0,i:!0,updateCartRequestInput:{items:[{article_id:`${n?.product?.uid}_${t}`,item_id:n?.product?.uid,item_size:t,item_index:o,quantity:0,identifiers:{identifier:n?.identifiers?.identifier}}],operation:"remove_item"}},i=await e.executeGQL(_,a,{skipStoreUpdate:!0});if(v(!1),i?.data?.updateCart?.success){alert("VIP exclusive item removed from cart","info"),console.log("Item removed successfully:",n?.product?.name);const t=await async function(n){return await(n?.executeGQL?.(m,{buyNow:!1,includeAllItems:!0,includeCodCharges:!0,includeBreakup:!0}))}(e);console.log("Updated cart data:",t)}else alert(i?.data?.updateCart?.message||"Failed to remove item","error");return i?.data?.updateCart}catch(n){console.error("Error removing cart item:",n),alert("An error occurred while removing the item","error"),v(!1)}})(n,n?.article?.size||n?.size,o))}))})(n,c),((n,e)=>{const o=window.location.pathname;if(console.log("Current path:",o),!o.includes("/product/")||!C||!n?.products)return void console.log("Not on a product page, skipping validation.");const a=C,i=a?.product_details?.item_code?.toLowerCase();console.log("Product page validation:",{path:o,product_item_code:i,is_vip:e}),i&&new Set([{item_code:"marv5rue_KD"}].map((n=>n.item_code?.toLowerCase()))).has(i)&&!e&&(console.log("Non-VIP user trying to access VIP product, redirecting..."),alert("This product is exclusive to VIP members only","error"),setTimeout((()=>{window.history.length>1?t(-1):t("/")}),2e3))})(n,c)}else console.log("No active campaigns found"),a(null)}else console.log("No campaigns found"),a(null)}catch(n){console.error("Error in VIP validation process:",n),g(n.message)}finally{s(!1)}})()}),[h,C,b]),f?l().createElement("div",{className:"vip-validation-updating"},l().createElement("p",null,"Updating cart...")):l().createElement(l().Fragment,null)}const g={label:"VIP validations product",name:"vip-product-validations",props:[],blocks:[]},f={"vip-product-validations":{...s}};return c})()));