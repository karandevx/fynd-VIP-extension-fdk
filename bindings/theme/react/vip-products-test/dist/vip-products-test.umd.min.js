!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("React"),require("sharedComponentLibrary"),require("sharedUtilsLibrary")):"function"==typeof define&&define.amd?define("extension",["React","sharedComponentLibrary","sharedUtilsLibrary"],t):"object"==typeof exports?exports.extension=t(require("React"),require("sharedComponentLibrary"),require("sharedUtilsLibrary")):e.extension=t(e.React,e.sharedComponentLibrary,e.sharedUtilsLibrary)}("undefined"!=typeof self?self:this,((e,t,n)=>(()=>{"use strict";var o={173:e=>{e.exports=n},667:e=>{e.exports=t},883:t=>{t.exports=e}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return o[e](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};r.r(a),r.d(a,{default:()=>f});var s={};r.r(s),r.d(s,{Component:()=>m,settings:()=>g});var l=r(883),c=r.n(l),d=r(667),p=r(173);const u='query User {\n  user {\n    logged_in_user {\n      id\n      account_type\n      active\n      dob\n      first_name\n      gender\n      last_name\n      profile_pic_url\n      user_id\n      username\n      emails {\n        active\n        email\n        primary\n        verified\n      }\n      phone_numbers {\n        active\n        country_code\n        phone\n        primary\n        verified\n      }\n    }\n    has_password {\n        result\n    }\n  }\n  followedListing(\n    collectionType: "products"\n  ) {\n    items {\n      uid\n    }\n    page {\n      current\n      next_id\n      has_previous\n      has_next\n      item_total\n      type\n      size\n    }\n  }\n}',_=()=>"undefined"!=typeof window;function m({props:e,globalConfig:t}){const n=(0,p.useFPI)(),o=(0,p.useGlobalStore)(n.getters.PLATFORM_DATA);console.log("platformData",o);const i=(0,p.useGlobalStore)(n.getters.LOGGED_IN),[r,a]=(0,l.useState)(!1),[s,m]=(0,l.useState)(!1),[g,f]=(0,l.useState)(0),[v,y]=(0,l.useState)(null),[b,h]=(0,l.useState)(!1),[I,w]=(0,l.useState)(!1),P="682c158a3d88c46a01efac53",{image_desktop_non_vip:k,image_mobile_non_vip:x,image_desktop_vip:L,image_mobile_vip:V,vip_cta_link:E,non_vip_banner_link:S}=e;(0,l.useEffect)((()=>{if(_()){const e=()=>{f(window?.innerWidth)};return a(document?.getElementsByTagName("body")?.[0]?.getBoundingClientRect()?.width<=768),window?.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}}),[]),(0,l.useEffect)((()=>{(async()=>{if(i)try{w(!0),console.log("Fetching user data...");const e=await n.executeGQL(u);console.log("User data fetched",e),y(e);const t=e?.data?.user?.logged_in_user?.id;console.log("FPI User ID:",t),console.log("Validating VIP status with Boltics API...");const o=await(async(e=P)=>{try{const t=await fetch(`https://fetch-db-data-d9ca324b.serverless.boltic.app?module=users&companyId=10253&queryType=validate&id=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error("Failed to validate VIP user");return await t.json()}catch(e){throw console.error("Error validating VIP user:",e),e}})(P);console.log("VIP validation response:",o);let i=!1;o.success&&o.data&&o.data.length>0?(i=!0,console.log("User is VIP:",o.data[0])):console.log("User is not VIP"),h(i)}catch(e){console.error("Error fetching user data or validating VIP status:",e),h(!1)}finally{w(!1)}else y(null),h(!1),w(!1)})()}),[i,n]);const j=()=>b?E?.value||"":S?.value||"",C={paddingBottom:`${t?.section_margin_bottom||0}px`,maxWidth:"100%",margin:"0 auto"},T={width:"100%",position:"relative",aspectRatio:_()&&window.innerWidth<=768?"4/5":"19/6",overflow:"hidden"},U={width:"100%",height:"100%",objectFit:"cover",objectPosition:"center",cursor:j().length>0?"pointer":"default"};if(!i)return null;if(I)return c().createElement("div",{style:C},c().createElement("div",{style:{width:"100%",height:"200px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5",borderRadius:"8px"}},c().createElement("p",null,"Loading personalized content...")));const R=_()&&window.innerWidth<=768?b?""!==V?.value?V?.value:"":""!==x?.value?x?.value:"":b?""!==L?.value?L?.value:"":""!==k?.value?k?.value:"";if(!R)return null;console.log("Rendering VIP Home Banner:",{isVipUser:b,currentImage:R,bannerLink:j()});const q=c().createElement("div",{style:T},c().createElement("img",{src:R,alt:(b?"VIP":"Non-VIP")+" Home Banner",style:U,onLoad:()=>m(!0),loading:"eager"}));return c().createElement("div",{style:C},j().length>0?c().createElement(d.FDKLink,{to:j()},q):q)}const g={label:"VIP Home Page",name:"vip-home",props:[{type:"image_picker",id:"image_desktop_non_vip",label:"Desktop Image (Non-VIP)",default:"",options:{aspect_ratio:"19:6",aspect_ratio_strict_check:!0}},{type:"image_picker",id:"image_mobile_non_vip",label:"Mobile Image (Non-VIP)",default:"",options:{aspect_ratio:"4:5",aspect_ratio_strict_check:!0}},{type:"image_picker",id:"image_desktop_vip",label:"Desktop Image (VIP)",default:"",options:{aspect_ratio:"19:6",aspect_ratio_strict_check:!0}},{type:"image_picker",id:"image_mobile_vip",label:"Mobile Image (VIP)",default:"",options:{aspect_ratio:"4:5",aspect_ratio_strict_check:!0}},{type:"url",id:"vip_cta_link",default:"",label:"VIP CTA Link (for VIP members)"},{type:"url",id:"non_vip_banner_link",default:"",label:"Non-VIP Banner Link"}],blocks:[]},f={"vip-home":{...s}};return a})()));
