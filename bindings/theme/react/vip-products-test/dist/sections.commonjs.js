(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{default:()=>c});var n={};e.r(n),e.d(n,{Component:()=>s,settings:()=>l});const o=require("fs");var a=e.n(o);const i='query User {\n  user {\n    logged_in_user {\n      id\n      account_type\n      active\n      dob\n      first_name\n      gender\n      last_name\n      profile_pic_url\n      user_id\n      username\n      emails {\n        active\n        email\n        primary\n        verified\n      }\n      phone_numbers {\n        active\n        country_code\n        phone\n        primary\n        verified\n      }\n    }\n    has_password {\n        result\n    }\n  }\n  followedListing(\n    collectionType: "products"\n  ) {\n    items {\n      uid\n    }\n    page {\n      current\n      next_id\n      has_previous\n      has_next\n      item_total\n      type\n      size\n    }\n  }\n}',r=()=>"undefined"!=typeof window;function s({props:e,globalConfig:t}){const n=(0,o.useFPI)(),s=(0,o.useGlobalStore)(n.getters.PLATFORM_DATA);console.log("platformData",s);const l=(0,o.useGlobalStore)(n.getters.LOGGED_IN),[c,d]=(0,o.useState)(!1),[p,u]=(0,o.useState)(!1),[_,g]=(0,o.useState)(0),[m,v]=(0,o.useState)(null),[f,h]=(0,o.useState)(!1),[y,b]=(0,o.useState)(!1),I="682c158a3d88c46a01efac53",{image_desktop_non_vip:w,image_mobile_non_vip:P,image_desktop_vip:k,image_mobile_vip:V,vip_cta_link:E,non_vip_banner_link:S}=e;(0,o.useEffect)((()=>{if(r()){const e=()=>{g(window?.innerWidth)};return d(document?.getElementsByTagName("body")?.[0]?.getBoundingClientRect()?.width<=768),window?.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}}),[]),(0,o.useEffect)((()=>{(async()=>{if(l)try{b(!0),console.log("Fetching user data...");const e=await n.executeGQL(i);console.log("User data fetched",e),v(e);const t=e?.data?.user?.logged_in_user?.id;console.log("FPI User ID:",t),console.log("Validating VIP status with Boltics API...");const o=await(async(e=I)=>{try{const t=await fetch(`https://fetch-db-data-d9ca324b.serverless.boltic.app?module=users&companyId=10253&queryType=validate&id=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error("Failed to validate VIP user");return await t.json()}catch(e){throw console.error("Error validating VIP user:",e),e}})(I);console.log("VIP validation response:",o);let a=!1;o.success&&o.data&&o.data.length>0?(a=!0,console.log("User is VIP:",o.data[0])):console.log("User is not VIP"),h(a)}catch(e){console.error("Error fetching user data or validating VIP status:",e),h(!1)}finally{b(!1)}else v(null),h(!1),b(!1)})()}),[l,n]);const L=()=>f?E?.value||"":S?.value||"",T={paddingBottom:`${t?.section_margin_bottom||0}px`,maxWidth:"100%",margin:"0 auto"},j={width:"100%",position:"relative",aspectRatio:r()&&window.innerWidth<=768?"4/5":"19/6",overflow:"hidden"},x={width:"100%",height:"100%",objectFit:"cover",objectPosition:"center",cursor:L().length>0?"pointer":"default"};if(!l)return null;if(y)return a().createElement("div",{style:T},a().createElement("div",{style:{width:"100%",height:"200px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5",borderRadius:"8px"}},a().createElement("p",null,"Loading personalized content...")));const B=r()&&window.innerWidth<=768?f?""!==V?.value?V?.value:"":""!==P?.value?P?.value:"":f?""!==k?.value?k?.value:"":""!==w?.value?w?.value:"";if(!B)return null;console.log("Rendering VIP Home Banner:",{isVipUser:f,currentImage:B,bannerLink:L()});const C=a().createElement("div",{style:j},a().createElement("img",{src:B,alt:(f?"VIP":"Non-VIP")+" Home Banner",style:x,onLoad:()=>u(!0),loading:"eager"}));return a().createElement("div",{style:T},L().length>0?a().createElement(o.FDKLink,{to:L()},C):C)}const l={label:"VIP Home Page",name:"vip-home",props:[{type:"image_picker",id:"image_desktop_non_vip",label:"Desktop Image (Non-VIP)",default:"",options:{aspect_ratio:"19:6",aspect_ratio_strict_check:!0}},{type:"image_picker",id:"image_mobile_non_vip",label:"Mobile Image (Non-VIP)",default:"",options:{aspect_ratio:"4:5",aspect_ratio_strict_check:!0}},{type:"image_picker",id:"image_desktop_vip",label:"Desktop Image (VIP)",default:"",options:{aspect_ratio:"19:6",aspect_ratio_strict_check:!0}},{type:"image_picker",id:"image_mobile_vip",label:"Mobile Image (VIP)",default:"",options:{aspect_ratio:"4:5",aspect_ratio_strict_check:!0}},{type:"url",id:"vip_cta_link",default:"",label:"VIP CTA Link (for VIP members)"},{type:"url",id:"non_vip_banner_link",default:"",label:"Non-VIP Banner Link"}],blocks:[]},c={"vip-home":{...n}};exports.sections=t})();
